import type { Resolvers } from '../../generated/graphql';
import { addExploit, findById } from './exploit-domain';
import {
  stixDomainObjectAddRelation,
  stixDomainObjectCleanContext,
  stixDomainObjectDelete, stixDomainObjectDeleteRelation,
  stixDomainObjectEditContext,
  stixDomainObjectEditField
} from '../../domain/stixDomainObject';

export const exploitResolvers: Resolvers = {
  Query: {
    exploit: (_, { id }, context) => findById(context, context.user, id)
  },
  Mutation: {
    exploitAdd: (_, { input }, context) => addExploit(context, context.user, input),
    exploitDelete: (_, { id }, context) => stixDomainObjectDelete(context, context.user, id),
    exploitFieldPatch: (_, { id, input, commitMessage, references }, context) => stixDomainObjectEditField(context, context.user, id, input, { commitMessage, references }),

    exploitContextPatch: (_, { id, input }, context) => stixDomainObjectEditContext(context, context.user, id, input),
    exploitContextClean: (_, { id }, context) => stixDomainObjectCleanContext(context, context.user, id),

    exploitRelationAdd: (_, { id, input }, context) => stixDomainObjectAddRelation(context, context.user, id, input),
    exploitRelationDelete: (_, { id, toId, relationship_type: relationshipType }, context) => stixDomainObjectDeleteRelation(context, context.user, id, toId, relationshipType)
  }
};
