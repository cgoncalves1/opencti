import type { Resolvers } from '../../generated/graphql';
import { addExploit, findById } from './exploit-domain';
import {
  stixDomainObjectDelete,
  stixDomainObjectEditContext,
  stixDomainObjectEditField
} from '../../domain/stixDomainObject';

export const exploitResolvers: Resolvers = {
  Query: {
    exploit: (_, { id }, context) => findById(context, context.user, id)
  },
  Mutation: {
    exploitAdd: (_, { input }, context) => addExploit(context, context.user, input),
    exploitDelete: (_, { id }, context) => stixDomainObjectDelete(context, context.user, id),
    exploitFieldPatch: (_, { id, input, commitMessage, references }, context) => stixDomainObjectEditField(context, context.user, id, input, { commitMessage, references }),
    exploitContextPatch: (_, { id, input }, context) => stixDomainObjectEditContext(context, context.user, id, input)
  }
};
